
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Pixel Tamagotchi - ÁÜä‰ªî">
    <title>Pixel Tamagotchi - ÁÜä‰ªî</title>
    <style>
        body, html {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background-color: #fff8e1;
            color: #333;
            height: 100%;
            overflow-y: scroll;
        }

        .pixel-container {
            display: grid;
            grid-template-columns: repeat(10, 20px);
            gap: 2px;
            margin: 20px auto;
            width: max-content;
        }

        .pixel {
            width: 20px;
            height: 20px;
            background-color: #ddd;
        }

        .active {
            background-color: #8b4513;
        }

        .eye {
            background-color: #000;
        }

        .food {
            background-color: #ffa500;
        }

        .toilet {
            background-color: #008000;
        }

        .sleep {
            background-color: #222;
        }

        button, input {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
        }

        .status-container {
            margin: 20px auto;
            width: 300px;
        }

        .status-bar {
            margin: 10px 0;
            background-color: #ddd;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .status-bar-inner {
            height: 100%;
            background-color: #76c7c0;
            width: 0%;
            transition: width 0.5s;
        }

        .time-indicator, .age-indicator {
            font-size: 18px;
            margin: 10px 0;
            font-weight: bold;
        }

        .save-code-container {
            margin: 20px;
            font-size: 18px;
        }

        #load-code-input {
            font-size: 18px;
            margin: 10px;
        }

        #saved-code {
            font-size: 18px;
            margin-top: 10px;
        }

        .death-message {
            font-size: 24px;
            color: red;
            margin: 20px;
            font-weight: bold;
        }

    </style>
</head>
<body>
    <h1>Pixel Tamagotchi - ÁÜä‰ªî v10</h1>
    <div id="pixel-pet" class="pixel-container"></div>
    <div>
        <button onclick="feedPet()">È§µÈ£ü</button>
        <button onclick="playWithPet()">Èô™Áé©</button>
        <button onclick="cleanPet()">Ê∏ÖÊΩî</button>
        <button onclick="restartGame()">ÈáçÊñ∞ÈñãÂßã</button>
    </div>
    <div class="status-container">
        <div>ËÇöÈ§ìÔºö<div class="status-bar"><div id="hunger-bar" class="status-bar-inner"></div></div></div>
        <div>ÂªÅÊâÄÔºö<div class="status-bar"><div id="toilet-bar" class="status-bar-inner"></div></div></div>
        <div>ÊÇ∂Ôºö<div class="status-bar"><div id="boredom-bar" class="status-bar-inner"></div></div></div>
    </div>
    <div class="time-indicator" id="time-indicator">ÁèæÂú®ÊôÇÈñìÔºö00:00</div>
    <div class="age-indicator" id="age-indicator">È£ºÈ§äÊó•Êï∏Ôºö0 Êó•</div>
    <div class="death-message" id="death-message" style="display: none;">ÁÜä‰ªîÊ≠ª‰∫°ÔºÅÈÅäÊà≤ÁµêÊùü</div>

    <div class="save-code-container">
        <button onclick="saveGame()">ÂÑ≤Â≠òÈÄ≤Â∫¶</button>
        <div id="saved-code"></div>
    </div>

    <div>
        <input type="text" id="load-code-input" placeholder="Ëº∏ÂÖ•8‰Ωç‰ª£Á¢º" maxlength="8">
        <button onclick="loadGame()">ËºâÂÖ•ÈÄ≤Â∫¶</button>
    </div>

    <script>
        const pixelPet = document.getElementById("pixel-pet");
        const hungerBar = document.getElementById("hunger-bar");
        const toiletBar = document.getElementById("toilet-bar");
        const boredomBar = document.getElementById("boredom-bar");
        const timeIndicator = document.getElementById("time-indicator");
        const ageIndicator = document.getElementById("age-indicator");
        const savedCodeDiv = document.getElementById("saved-code");
        const loadCodeInput = document.getElementById("load-code-input");
        const deathMessage = document.getElementById("death-message");

        let hunger = 0;
        let toilet = 0;
        let boredom = 0;
        let age = 0;
        let isSleeping = false;
        let currentState = "normal"; // Áî®‰æÜËøΩËπ§ÁõÆÂâçÁãÄÊÖã
        let frameIndex = 0;
        let savedCode = "";

        const frames = {
            normal: [
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..######..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#.O..#..",
                    "..######..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ]
            ],
            eating: [
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..##FOOD..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..FOOD##..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ]
            ],
            toilet: [
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#.O..#..",
                    "..######..",
                    "...#üíß.#...",
                    "...####...",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..######..",
                    "...#üíß.#...",
                    "...#  üíß..",
                    "..........",
                    ".........."
                ]
            ],
            sleeping: [
                [
                    "..........",
                    "...ZZZZ...",
                    "..Z....Z..",
                    "..Z....Z..",
                    "...ZZZZ...",
                    "..........",
                    "..........",
                    "..........",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "..........",
                    "..ZZZZZ...",
                    "..Z....Z..",
                    "..ZZZZZZ..",
                    "..........",
                    "..........",
                    "..........",
                    "..........",
                    ".........."
                ]
            ],
            playing: [
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..##PLAY..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..PLAY##..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ]
            ],
            dead: [
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#....#..",
                    "..######..",
                    "...####...",
                    "...####...",
                    "..........",
                    ".........."
                ]
            ]
        };

        function createPixels() {
            for (let i = 0; i < 100; i++) {
                const pixel = document.createElement("div");
                pixel.classList.add("pixel");
                pixelPet.appendChild(pixel);
            }
        }

        function renderFrame(frameType) {
            const pixels = document.querySelectorAll(".pixel");
            const frame = frames[frameType][frameIndex % frames[frameType].length];
            const rows = frame.join("");
            for (let i = 0; i < pixels.length; i++) {
                if (rows[i] === "#") {
                    pixels[i].classList.add("active");
                } else if (rows[i] === "O") {
                    pixels[i].classList.add("eye");
                } else if (rows[i] === "F") {
                    pixels[i].classList.add("food");
                } else if (rows[i] === "üíß") {
                    pixels[i].classList.add("toilet");
                } else if (rows[i] === "Z") {
                    pixels[i].classList.add("sleep");
                } else if (rows[i] === "P") {
                    pixels[i].classList.add("play");
                } else {
                    pixels[i].classList.remove("active", "eye", "food", "toilet", "sleep", "play");
                }
            }
            frameIndex++;
        }

        function updateStatusBars() {
            hungerBar.style.width = hunger + "%";
            toiletBar.style.width = toilet + "%";
            boredomBar.style.width = boredom + "%";
        }

        function checkDeath() {
            if (hunger >= 100 || toilet >= 100 || boredom >= 100) {
                currentState = "dead";
                deathMessage.style.display = "block";
                setTimeout(() => {
                    alert("ÁÜä‰ªîÂ∑≤Ê≠ª‰∫°ÔºåÈÅäÊà≤ÁµêÊùüÔºÅ");
                    restartGame();
                }, 2000); // 2ÁßíÂæåÈáçÂïüÈÅäÊà≤
            }
        }

        function updateRealTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const formattedTime = `${hours.toString().padStart(2, "0")}:${minutes.toString().padStart(2, "0")}`;
            timeIndicator.textContent = `ÁèæÂú®ÊôÇÈñìÔºö${formattedTime}`;

            if (hours >= 21 || hours < 8) {
                isSleeping = true;
                currentState = "sleeping";
            } else {
                isSleeping = false;
            }

            updateStatusBars();
        }

        function updatePetStatus() {
            if (currentState !== "dead" && !isSleeping) {
                hunger = Math.min(100, hunger + 1);
                toilet = Math.min(100, toilet + 1);
                boredom = Math.min(100, boredom + 1);
                age += 1; // Â¢ûÂä†È£ºÈ§äÊó•Êï∏
            }
            if (currentState !== "dead") {
                updateStatusBars();
                checkDeath();
            }
        }

        function feedPet() {
            if (currentState !== "dead") {
                hunger = Math.max(0, hunger - 20);
                currentState = "eating";
                setTimeout(() => (currentState = isSleeping ? "sleeping" : "normal"), 3000);
            }
        }

        function playWithPet() {
            if (currentState !== "dead") {
                boredom = Math.max(0, boredom - 20);
                currentState = "playing";
                setTimeout(() => (currentState = isSleeping ? "sleeping" : "normal"), 3000);
            }
        }

        function cleanPet() {
            if (currentState !== "dead") {
                toilet = Math.max(0, toilet - 30);
                currentState = "toilet";
                setTimeout(() => (currentState = isSleeping ? "sleeping" : "normal"), 3000);
            }
        }

        function restartGame() {
            hunger = 0;
            toilet = 0;
            boredom = 0;
            age = 0;
            deathMessage.style.display = "none";
            currentState = "normal";
            frameIndex = 0;
            renderFrame(currentState);
            updateRealTime();
        }

        function saveGame() {
            const gameData = `${hunger},${toilet},${boredom},${age}`;
            savedCode = btoa(gameData); // ‰ΩøÁî®base64Á∑®Á¢ºÂÑ≤Â≠òÈÅäÊà≤ÁãÄÊÖã
            savedCodeDiv.textContent = `ÂÑ≤Â≠ò‰ª£Á¢ºÔºö${savedCode}`;
        }

        function loadGame() {
            const code = loadCodeInput.value;
            try {
                const gameData = atob(code); // Ëß£Á¢ºbase64
                const [hungerValue, toiletValue, boredomValue, ageValue] = gameData.split(",");
                hunger = parseInt(hungerValue, 10);
                toilet = parseInt(toiletValue, 10);
                boredom = parseInt(boredomValue, 10);
                age = parseInt(ageValue, 10);
                alert("ÈÅäÊà≤Â∑≤ËºâÂÖ•ÔºÅ");
                restartGame();
            } catch (e) {
                alert("ÁÑ°ÊïàÁöÑ‰ª£Á¢ºÔºÅ");
            }
        }

        createPixels();
        setInterval(updateRealTime, 60000); // ÊØèÂàÜÈêòÊõ¥Êñ∞‰∏ÄÊ¨°ÊôÇÈñì
        setInterval(updatePetStatus, 1000); // ÊØèÁßíÊõ¥Êñ∞‰∏ÄÊ¨°ÁãÄÊÖã
        setInterval(() => renderFrame(currentState), 300); // ÊØè300ÊØ´ÁßíÊõ¥Êñ∞‰∏ÄÊ¨°ÂãïÁï´
    </script>
</body>
</html>
