
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Pixel Tamagotchi - ÁÜä‰ªî">
    <title>Pixel Tamagotchi - ÁÜä‰ªî</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 0;
            padding: 0;
            background-color: #fff8e1;
            color: #333;
            height: 100%;
            overflow: hidden;
        }

        .pixel-container {
            display: grid;
            grid-template-columns: repeat(10, 20px);
            gap: 2px;
            margin: 20px auto;
            width: max-content;
        }

        .pixel {
            width: 20px;
            height: 20px;
            background-color: #ddd;
        }

        .active {
            background-color: #8b4513;
        }

        .eye {
            background-color: #000;
        }

        .food {
            background-color: #ffa500;
        }

        .toilet {
            background-color: #008000;
        }

        .sleep {
            background-color: #222;
        }

        button, input {
            margin: 5px;
            padding: 10px 20px;
            font-size: 16px;
        }

        .status-container {
            margin: 20px auto;
            width: 300px;
        }

        .status-bar {
            margin: 10px 0;
            background-color: #ddd;
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .status-bar-inner {
            height: 100%;
            background-color: #76c7c0;
            width: 0%;
            transition: width 0.5s;
        }

        .time-indicator, .age-indicator {
            font-size: 18px;
            margin: 10px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Pixel Tamagotchi - ÁÜä‰ªî</h1>
    <div id="pixel-pet" class="pixel-container"></div>
    <div>
        <button onclick="feedPet()">È§µÈ£ü</button>
        <button onclick="playWithPet()">Èô™Áé©</button>
        <button onclick="cleanPet()">Ê∏ÖÊΩî</button>
        <button onclick="restartGame()">ÈáçÊñ∞ÈñãÂßã</button>
        <button onclick="saveGame()">ÂÑ≤Â≠òÈÄ≤Â∫¶</button>
        <button onclick="loadGame()">ËºâÂÖ•ÈÄ≤Â∫¶</button>
    </div>
    <div class="status-container">
        <div>ËÇöÈ§ìÔºö<div class="status-bar"><div id="hunger-bar" class="status-bar-inner"></div></div></div>
        <div>ÂªÅÊâÄÔºö<div class="status-bar"><div id="toilet-bar" class="status-bar-inner"></div></div></div>
        <div>ÊÇ∂Ôºö<div class="status-bar"><div id="boredom-bar" class="status-bar-inner"></div></div></div>
    </div>
    <div class="time-indicator" id="time-indicator">ÁèæÂú®ÊôÇÈñìÔºö00:00</div>
    <div class="age-indicator" id="age-indicator">È£ºÈ§äÊó•Êï∏Ôºö0 Êó•</div>
    <script>
        const pixelPet = document.getElementById("pixel-pet");
        const hungerBar = document.getElementById("hunger-bar");
        const toiletBar = document.getElementById("toilet-bar");
        const boredomBar = document.getElementById("boredom-bar");
        const timeIndicator = document.getElementById("time-indicator");
        const ageIndicator = document.getElementById("age-indicator");

        let hunger = 0;
        let toilet = 0;
        let boredom = 0;
        let age = 0;
        let isSleeping = false;
        let currentState = "normal"; // Áî®‰æÜËøΩËπ§ÁõÆÂâçÁãÄÊÖã
        let frameIndex = 0;

        const frames = {
            normal: [
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..######..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#.O..#..",
                    "..######..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ]
            ],
            eating: [
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..##FOOD..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..FOOD##..",
                    "...#..#...",
                    "...####...",
                    "..........",
                    ".........."
                ]
            ],
            toilet: [
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#.O..#..",
                    "..######..",
                    "...#üíß.#...",
                    "...####...",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "...####...",
                    "..######..",
                    "..#....#..",
                    "..#..O.#..",
                    "..######..",
                    "...#üíß.#...",
                    "...#  üíß..",
                    "..........",
                    ".........."
                ]
            ],
            sleeping: [
                [
                    "..........",
                    "...ZZZZ...",
                    "..Z....Z..",
                    "..Z....Z..",
                    "...ZZZZ...",
                    "..........",
                    "..........",
                    "..........",
                    "..........",
                    ".........."
                ],
                [
                    "..........",
                    "..........",
                    "..ZZZZZ...",
                    "..Z....Z..",
                    "..ZZZZZZ..",
                    "..........",
                    "..........",
                    "..........",
                    "..........",
                    ".........."
                ]
            ]
        };

        function createPixels() {
            for (let i = 0; i < 100; i++) {
                const pixel = document.createElement("div");
                pixel.classList.add("pixel");
                pixelPet.appendChild(pixel);
            }
        }

        function renderFrame(frameType) {
            const pixels = document.querySelectorAll(".pixel");
            const frame = frames[frameType][frameIndex % frames[frameType].length];
            const rows = frame.join("");
            for (let i = 0; i < pixels.length; i++) {
                if (rows[i] === "#") {
                    pixels[i].classList.add("active");
                } else if (rows[i] === "O") {
                    pixels[i].classList.add("eye");
                } else if (rows[i] === "F") {
                    pixels[i].classList.add("food");
                } else if (rows[i] === "üíß") {
                    pixels[i].classList.add("toilet");
                } else if (rows[i] === "Z") {
                    pixels[i].classList.add("sleep");
                } else {
                    pixels[i].classList.remove("active", "eye", "food", "toilet", "sleep");
                }
            }
            frameIndex++;
        }

        function updateStatusBars() {
            hungerBar.style.width = hunger + "%";
            toiletBar.style.width = toilet + "%";
            boredomBar.style.width = boredom + "%";
        }

        function updateRealTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const formattedTime = `${hours.toString().padStart(2, "0")}:${minutes.toString().padStart(2, "0")}`;
            timeIndicator.textContent = `ÁèæÂú®ÊôÇÈñìÔºö${formattedTime}`;

            if (hours >= 21 || hours < 8) {
                isSleeping = true;
                currentState = "sleeping";
            } else {
                isSleeping = false;
                currentState = "normal";
            }
        }

        function updatePetStatus() {
            if (!isSleeping) {
                hunger += 0.5;
                toilet += 0.3;
                boredom += 0.3;
            }
            updateStatusBars();
        }

        function feedPet() {
            hunger = Math.max(0, hunger - 30);
            currentState = "eating";
            setTimeout(() => (currentState = isSleeping ? "sleeping" : "normal"), 3000);
        }

        function cleanPet() {
            toilet = Math.max(0, toilet - 30);
            currentState = "toilet";
            setTimeout(() => (currentState = isSleeping ? "sleeping" : "normal"), 3000);
        }

        function restartGame() {
            hunger = 0;
            toilet = 0;
            boredom = 0;
            age = 0;
            updateStatusBars();
            ageIndicator.textContent = `È£ºÈ§äÊó•Êï∏Ôºö${age} Êó•`;
        }

        function saveGame() {
            const gameState = {
                hunger: hunger,
                toilet: toilet,
                boredom: boredom,
                age: age,
                currentState: currentState
            };
            const gameStateString = JSON.stringify(gameState);
            const encodedGameState = btoa(gameStateString).slice(0, 8); // Á∑®Á¢º‰∏¶Êà™Âèñ8‰ΩçÂ≠óÁ¨¶
            localStorage.setItem("tamagotchiState", encodedGameState);
            alert("ÈÅäÊà≤ÈÄ≤Â∫¶Â∑≤ÂÑ≤Â≠òÔºÅ");
        }

        function loadGame() {
            const savedState = localStorage.getItem("tamagotchiState");
            if (savedState) {
                const decodedState = atob(savedState); // Ëß£Á¢º
                const gameState = JSON.parse(decodedState);
                hunger = gameState.hunger;
                toilet = gameState.toilet;
                boredom = gameState.boredom;
                age = gameState.age;
                currentState = gameState.currentState;
                updateStatusBars();
                ageIndicator.textContent = `È£ºÈ§äÊó•Êï∏Ôºö${age} Êó•`;
                alert("ÈÅäÊà≤ÈÄ≤Â∫¶Â∑≤ËºâÂÖ•ÔºÅ");
            } else {
                alert("ÁÑ°ÂÑ≤Â≠òÁöÑÈÅäÊà≤ÈÄ≤Â∫¶ÔºÅ");
            }
        }

        setInterval(updateRealTime, 1000);
        setInterval(updatePetStatus, 5000);
        setInterval(() => {
            renderFrame(currentState);
        }, 333); // ÊØèÁßí 3 ÂπÄÂãïÁï´

        createPixels();
        renderFrame("normal");
        updateStatusBars();
    </script>
</body>
</html>
